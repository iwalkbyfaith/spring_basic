<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http:/mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- ↑↑ 위쪽에는 마이바티스에서 사용할 xml 파일임을 명시.
	 ↓↓ 아래쪽 mapper 태그의 namespace에 어떤 인터페이스와 연동할지 패키지부터 다 적음 -->

<!-- 단일자료를 적는 것만으로도 마이바티스가 알아서 계산을해서 resultType에 List이면 알아서 리스트로 만들어줌.
	 즉, 마이바티스에서는 List 타입이 없는 것(BoardVO만 적어도 리스트일 경우 알아서 계산해준다는 것) 
	 ==> 마이바티스의 최고 장점 (이전에는 리스트 만들어서 .add로 넣어주고.. 이런 과정이 있었다면 이제는 간단해짐)
-->

<!-- <이나 >와 같이 태그로 오인될 수 있는 문자를 포함하는 쿼리문은 그냥 작성하지 않고 CDATA를 이용한다. <- 씨-데이터 라고 읽음
	 아래와 같이 <![CDATA[실행문]]>과 같이 실행문을 CDATA내부에 작성하면 내부의 부등호는 전부 문자로 간주된다.
	 만약 그냥 꺽쇠만 넣으면 초록색으로 표시되고 태그를 여는(혹은 닫는) 형태로 인식하게 됨.
	 
	 resultType -> SELECT에만 있음, 마이바티스 태그 내에서는 리스트를 안 적어줘도 됨(인터페이스의 메서드에서만 잘 표시해주면 됨)
 -->

	<!-- BoardMapper(인터페이스)와 연결해줌 -->
	<mapper namespace="com.ict.mapper.BoardMapper">
		
		
		<!-- 04.11 페이징처리를 위한 변경 -->
		<!-- ■ SELECT : 모든 리스트 받아오기 -->
		<select id="getList" resultType="com.ict.domain.BoardVO">
			<![CDATA[
				SELECT * FROM
					(SELECT /*+ INDEX_DESC(board_tbl pk_board) */
					rownum rn, board_tbl.* FROM board_tbl WHERE rownum <= (#{pageNum} * 10))
						WHERE rn > ((#{pageNum}-1) * 10)
			]]>
		</select>
		
		
		<!-- ■ INSERT : row 1개 적재하기 -->
			<!-- insert 구문이므로 insert 태그를 써야하고, 리턴 자료가 없으니 resultType도 작성 안합니다.
				 BoardVO를 입력 받지만 #{} 내부에는 vo.변수명이 아닌, 해당 VO의 멤버변수 이름을 써줍니다.	-->
		<insert id="insert">
			INSERT INTO board_tbl (bno, title, content, writer)
				VALUES 
			(board_num.nextval, #{title}, #{content}, #{writer})
		</insert>
		
		
		<!-- ■ SELECT : row 1개 가져오기 (글번호 받아서) -->
		<select id="getBoard" resultType="com.ict.domain.BoardVO">
			SELECT * FROM board_tbl WHERE bno = #{bno}
		</select>
		
		
		<!-- ■ DELETE : row 한 개 삭제하기 (글번호 받음) -->
		<delete id="deleteBoard">
			DELETE FROM board_tbl WHERE bno = #{bno}
		</delete>
		
		
		<!-- ■ UPDATE : row 한 개 수정하기 (제목, 글번호 받음) -->
		<update id="updateBoard">
			UPDATE board_tbl SET title=#{title} WHERE bno=#{bno}
		</update>
		
		<!-- ■ UPDATE2 : row 한 개 수정하기 (BoardVO 받음) -->
		<update id="updateBoard2">
			UPDATE board_tbl 
				SET	
			title=#{title}, content=#{content}, updatedate=SYSDATE 
				WHERE 
			bno=#{bno}
		</update>
	
	
	
	</mapper>
	
	<!-- id속성 = BoardMapper에 적어둔 메서드 이름
		 resultType = 리턴 자료형인 BoardVO를 패키지부터
	 -->